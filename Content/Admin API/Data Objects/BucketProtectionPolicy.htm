<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:lastBlockDepth="7" MadCap:lastHeight="3483" MadCap:lastWidth="882">
    <head>
    </head>
    <body>
        <h1>BucketProtectionPolicy</h1>
        <p class="TopicTag" MadCap:conditions="General.Online">[Admin API Object]</p>
        <p>The BucketProtectionPolicy object is returned as the <b>response payload</b> for these Admin API operations:</p>
        <ul>
            <li>
                <MadCap:xref href="../Storage Policies/GetStoragePolicy.htm">GET Storage Policy</MadCap:xref>
            </li>
            <li>
                <MadCap:xref href="../Storage Policies/GetStoragePolicyList.htm">GET Storage Policy List</MadCap:xref>
            </li>
            <li>
                <MadCap:xref href="../Storage Policies/PostUpdatedStoragePolicy.htm">POST Updated Storage Policy</MadCap:xref>
            </li>
            <li>
                <MadCap:xref href="../Storage Policies/PutNewStoragePolicy.htm">PUT New Storage Policy</MadCap:xref>
            </li>
        </ul>
        <p>The BucketProtectionPolicy object is required as the <b>request payload</b> for these Admin API operations:</p>
        <ul>
            <li>
                <MadCap:xref href="../Storage Policies/PostUpdatedStoragePolicy.htm">POST Updated Storage Policy</MadCap:xref>
            </li>
            <li>
                <MadCap:xref href="../Storage Policies/PutNewStoragePolicy.htm">PUT New Storage Policy</MadCap:xref>
            </li>
        </ul>
        <p>The BucketProtectionPolicy object consists of the attributes below. Each attribute description indicates whether the attribute is mandatory or optional when this object is transmitted as a request payload.</p>
        <p class="Note" MadCap:autonum="&lt;b&gt;Note &#160;&lt;/b&gt;">For more information about replication and erasure coding schemes, consistency level requirements, and other attributes of a storage policy definition, see <MadCap:xref href="../../CMC Interface/Cluster/Storage Policies/StoragePoliciesAdd.htm" target="_popup">Add a Storage Policy</MadCap:xref>.</p>
        <MadCap:dropDown>
            <MadCap:dropDownHead class="CloudianChildDropDown">
                <MadCap:dropDownHotspot>consistencyLevel</MadCap:dropDownHotspot>
            </MadCap:dropDownHead>
            <MadCap:dropDownBody>
                <div class="Indent">
                    <p>(Mandatory, ConsistencyLevel) Data consistency requirements definition, in format "{"read":["&lt;level&gt;"],"write":["&lt;level&gt;"],"writeNew":["&lt;level&gt;"], "metadataR":["&lt;level&gt;"],"metadataW":["&lt;level&gt;"],"readEC":["&lt;level&gt;"], "writeEC":["&lt;level&gt;"]}".</p>
                    <p>The &lt;level&gt; is one of ALL, EACH_ALL, LOCAL_ALL, QUORUM, EACH_QUORUM, LOCAL_QUORUM, or ONE — with the valid options being dependent on the type of environment (replication versus erasure coding and single-DC versus multi-DC) and the type of data (object data versus object metadata). Optionally the &lt;level&gt; part can be a comma-separated list of levels, if you want to use "dynamic" consistency levels.</p>
                    <p>For information about the supported consistency levels see the CMC Help topic on Data Consistency Level and Metadata Consistency Level.</p>
                    <p>When specifying data consistency requirements:</p>
                    <ul>
                        <li><b>For replication schemes</b>, specify consistency requirements for operation types "read", "write", "writeNew", "metadataR", and "metadataW". Omit "readEC" and "writeEC".</li>
                        <li><b>For erasure coding schemes</b>, specify consistency requirements for operation types "readEC" and "writeEC", "metadataR", and "metadataW". Omit "read", "write", and "writeNew". Note that the system actually ignores the value that you supply for "readEC" (since read consistency for EC data is no longer configurable starting with HyperStore version 6.0). Just assign "readEC" the value "LOCAL_QUORUM". Regardless, EC reads will succeed so long as "k" unique fragments are available.</li>
                    </ul>
                </div>
            </MadCap:dropDownBody>
        </MadCap:dropDown>
        <MadCap:dropDown>
            <MadCap:dropDownHead class="CloudianChildDropDown">
                <MadCap:dropDownHotspot>defaultProtectionScheme</MadCap:dropDownHotspot>
            </MadCap:dropDownHead>
            <MadCap:dropDownBody>
                <div class="Indent">
                    <p>(Optional, string) One of:</p>
                    <ul>
                        <li>"HSFS" (replication)</li>
                        <li>"EC" (erasure coding)</li>
                    </ul>
                    <p>This is generated by the system and can be ommitted in client request bodies. The value of this attribute in client request bodies is ignored by the system.</p>
                </div>
            </MadCap:dropDownBody>
        </MadCap:dropDown>
        <MadCap:dropDown>
            <MadCap:dropDownHead class="CloudianChildDropDown">
                <MadCap:dropDownHotspot>ecscheme</MadCap:dropDownHotspot>
            </MadCap:dropDownHead>
            <MadCap:dropDownBody>
                <div class="Indent">
                    <p>(Optional, ECScheme) Definition of the erasure coding scheme, in the form of "{"k":&lt;number&gt;,"m":&lt;number&gt;,"dc":["&lt;datacenter-name-string&gt;","&lt;datacenter-name-string&gt;"], "type":"&lt;ectype-string&gt;"}".</p>
                    <p>The "dc" element is a bracket-enclosed list of data centers in which erasure coded data will be stored for this policy. For each stored object, a full set of "k" + "m" fragments will be stored in each listed data center.</p>
                    <p>The "type" element is generated by the system and can be ommitted in client request bodies. Value of this element in client request bodies is ignored by the system.</p>
                    <p>The HyperStore system supports only the following "k" + "m" configurations:</p>
                    <ul>
                        <li>2+1</li>
                        <li>4+2</li>
                        <li>6+2</li>
                        <li>8+2</li>
                        <li>9+3</li>
                        <li>12+4</li>
                    </ul>
                    <p>If the policy that is being created is a replication scheme, <b>do not</b> include the "ecscheme" attribute in the BucketProtectionPolicy.</p>
                </div>
            </MadCap:dropDownBody>
        </MadCap:dropDown>
        <MadCap:dropDown>
            <MadCap:dropDownHead class="CloudianChildDropDown">
                <MadCap:dropDownHotspot>groups</MadCap:dropDownHotspot>
            </MadCap:dropDownHead>
            <MadCap:dropDownBody>
                <div class="Indent">
                    <p>(Mandatory, Set&lt;string&gt;) Comma-separate list of groups that are allowed to use this storage policy. Leave the set empty to allow all user groups to use this policy.</p>
                    <p>If you want to make a policy the system default policy, its "groups" value must be empty. The system default storage policy must be available to all groups.</p>
                </div>
            </MadCap:dropDownBody>
        </MadCap:dropDown>
        <MadCap:dropDown>
            <MadCap:dropDownHead class="CloudianChildDropDown">
                <MadCap:dropDownHotspot>policyDescription</MadCap:dropDownHotspot>
            </MadCap:dropDownHead>
            <MadCap:dropDownBody>
                <div class="Indent">
                    <p>(Optional, string) Policy description. Maximum 64 bytes.</p>
                </div>
            </MadCap:dropDownBody>
        </MadCap:dropDown>
        <MadCap:dropDown>
            <MadCap:dropDownHead class="CloudianChildDropDown">
                <MadCap:dropDownHotspot>policyId</MadCap:dropDownHotspot>
            </MadCap:dropDownHead>
            <MadCap:dropDownBody>
                <div class="Indent">
                    <p>(Mandatory, string) System-generated unique identifier of the storage policy</p>
                    <p>In a <MadCap:xref href="../Storage Policies/PutNewStoragePolicy.htm">PUT New Storage Policy</MadCap:xref> request, the BucketProtectionPolicy JSON object in the request body must include the "policyId" attribute, <b>with its value empty</b>.</p>
                    <p>For subsequent POST requests to update the same policy, the "policyId" value must be specified in the BucketProtectionPolicy object.</p>
                </div>
            </MadCap:dropDownBody>
        </MadCap:dropDown>
        <MadCap:dropDown>
            <MadCap:dropDownHead class="CloudianChildDropDown">
                <MadCap:dropDownHotspot>policyName</MadCap:dropDownHotspot>
            </MadCap:dropDownHead>
            <MadCap:dropDownBody>
                <div class="Indent">
                    <p>(Mandatory, string) &#160;Policy name. Maximum 32 bytes.</p>
                </div>
            </MadCap:dropDownBody>
        </MadCap:dropDown>
        <MadCap:dropDown>
            <MadCap:dropDownHead class="CloudianChildDropDown">
                <MadCap:dropDownHotspot>region</MadCap:dropDownHotspot>
            </MadCap:dropDownHead>
            <MadCap:dropDownBody>
                <div class="Indent">
                    <p>(Mandatory, string) Service region with which the policy is associated.</p>
                </div>
            </MadCap:dropDownBody>
        </MadCap:dropDown>
        <MadCap:dropDown>
            <MadCap:dropDownHead class="CloudianChildDropDown">
                <MadCap:dropDownHotspot>replicationScheme</MadCap:dropDownHotspot>
            </MadCap:dropDownHead>
            <MadCap:dropDownBody>
                <div class="Indent">
                    <p>(Optional, map&lt;string,string&gt;) Definition of the replication scheme, in the form of a comma-separated list of "&lt;datacenter-name&gt;":"&lt;replication-factor&gt;" pairs. For example "{"DC1":"3"}" for a single data center storage policy or "{"DC1":"3","DC2":"2"}" for a multi-data center policy.</p>
                    <p>If the policy that is being created is an erasure coding scheme, <b>do not</b> include the "replicationScheme" attribute in the BucketProtectionPolicy.</p>
                </div>
            </MadCap:dropDownBody>
        </MadCap:dropDown>
        <MadCap:dropDown>
            <MadCap:dropDownHead class="CloudianChildDropDown">
                <MadCap:dropDownHotspot>status</MadCap:dropDownHotspot>
            </MadCap:dropDownHead>
            <MadCap:dropDownBody>
                <div class="Indent">
                    <p>(Optional, PolicyStatus) One of the following strings:</p>
                    <ul>
                        <li>"PENDING" — The policy is in the process of being created in the system. In this state the policy is not yet available to be used.</li>
                        <li>"ACTIVE" — The policy is available to users when they create a new bucket.</li>
                        <li>"DISABLED" — The policy is no longer available to users when they create a new bucket. However, the policy still exists in the system and is still being applied to any buckets to which the policy was assigned during the period when it was active.</li>
                        <li>"DELETED" — The policy has been deleted from the system. Only policies that have never been assigned to any bucket can be deleted.</li>
                        <li>"FAILED" — The policy failed to be set up properly in the system. Though a BucketProtectionPolicy object exists and can be retrieved through the Admin API, the policy is not actually set up in the system. To have the policy set up in the system, delete the FAILED policy (using the DELETE Storage Policy method) and then try again to create a policy with the desired characteristics (using the PUT New Storage Policy method).</li>
                    </ul>
                    <p>The "status" value is generated by the system. The value of this attribute in client request bodies is ignored by the system.</p>
                </div>
            </MadCap:dropDownBody>
        </MadCap:dropDown>
        <MadCap:dropDown>
            <MadCap:dropDownHead class="CloudianChildDropDown">
                <MadCap:dropDownHotspot>systemDefault</MadCap:dropDownHotspot>
            </MadCap:dropDownHead>
            <MadCap:dropDownBody>
                <div class="Indent">
                    <p>(Mandatory, boolean) Whether the policy is the default storage policy for the region, <em>true</em> or <em>false</em>.</p>
                    <p>You cannot use a POST operation to change a storage policy’s "systemDefault" value from true to false. Instead, if you want to promote some other policy to become the system default policy, PUT or POST that policy with its "systemDefault" value set to true. The system will then automatically demote the existing system default policy (by setting that policy’s "systemDefault" value to false.</p>
                </div>
            </MadCap:dropDownBody>
        </MadCap:dropDown>
        <h2>Example</h2>
        <p>This first example shows a BucketProtectionPolicy object for a replication storage policy. This is the system default policy and it specifies 3X replication. Note that the "ecscheme" attribute is null. Within the consistency level requirements specification, the "readEC" and "writeEC" attributes are ignored.</p><pre xml:space="preserve">{"policyName":"hsfs-policy","policyDescription":"3X Replication","consistencyLevel":{"read":
["QUORUM"],"write":["QUORUM"],"writeNew":["QUORUM"],"metadataR":["QUORUM"],"metadataW":["QUORUM"],
"readEC":["EACH_QUORUM"],"writeEC":["LOCAL_QUORUM"]},"ecscheme":null,"defaultProtectionScheme":
"HSFS","status":"ACTIVE","replicationScheme":{"DC1":"3"},"systemDefault":true,"groups":[],
"policyId":"ea91c90e80936f22ceebf305d7b45e78","region":"region1"}</pre>
        <p>This second example shows a BucketProtectionPolicy object for an erasure coding storage policy. The policy specifies 2+1 erasure coding. Note that the "replicationScheme" attribute is null. Within the consistency level requirements specification, the "read", "write", and "writeNew" attributes are ignored.</p><pre xml:space="preserve">{"policyName":"ec-policy","policyDescription":"2+1 Erasure Coding","consistencyLevel":{"read":
["LOCAL_QUORUM"],"write":["ALL"],"writeNew":["ALL"],"metadataR":["QUORUM"],"metadataW":["QUORUM"],
"readEC":["LOCAL_QUORUM"],"writeEC":["ALL"]},"ecscheme":{"k":2,"m":1,"dc":["DC1"],"type":"DC"},
"defaultProtectionScheme":"EC","status":"ACTIVE","replicationScheme":null,"systemDefault":false,
"groups":[],"policyId":"e810cb2dc3be840d8a07e5dfb2d4d997","region":"region1"}</pre>
    </body>
</html>