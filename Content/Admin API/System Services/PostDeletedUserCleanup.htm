<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:lastBlockDepth="10" MadCap:lastHeight="1616" MadCap:lastWidth="752">
    <head>
    </head>
    <body>
        <h1>POST Deleted User Cleanup</h1>
        <p class="TopicTag" MadCap:conditions="General.Online">[Admin API Method]</p>
        <p>Use this Admin API method to try to complete the user deletion process for users for whom the deletion process failed to complete on the original attempt. These are users who are stuck in "Deleting" status for one reason or another.</p>
        <p class="Note" MadCap:autonum="&lt;b&gt;Note &#160;&lt;/b&gt;">This operation is invoked once a day by the HyperStore <MadCap:xref href="../../Maintenance/CronJobs.htm#User" target="_popup">User Deletion Cleanup</MadCap:xref> cron job. In a multi-region system, the cron job is run only in the default region. Since the user inventory is universal for the whole system, it’s not necessary to run this operation on a per-region basis (and any attempt to run it in a non-default region will be rejected by the Admin Service).</p>
        <MadCap:dropDown>
            <MadCap:dropDownHead class="CloudianParentDropDown">
                <MadCap:dropDownHotspot>Request Format</MadCap:dropDownHotspot>
            </MadCap:dropDownHead>
            <MadCap:dropDownBody>
                <h4>Syntax</h4><pre xml:space="preserve">POST /system/deletedUserCleanup[?userId=xxx&amp;groupId=xxx|canonicalUserId=xxx]</pre>
                <h4>Query Parameters</h4>
                <MadCap:dropDown>
                    <MadCap:dropDownHead class="CloudianChildDropDown">
                        <MadCap:dropDownHotspot>userId</MadCap:dropDownHotspot>
                    </MadCap:dropDownHead>
                    <MadCap:dropDownBody>
                        <div class="Indent">
                            <p>(Optional, string) User ID of the user to finish deleting.</p>
                            <p>If no user is specified, then this operation will get the list of all users in "Deleting" status and attempt to delete their data and metadata. If you do want to specify a user, then <b>either</b> use "userId" together with "groupId", <b>or</b> use "canonicalUserId" by itself.</p>
                        </div>
                    </MadCap:dropDownBody>
                </MadCap:dropDown>
                <MadCap:dropDown>
                    <MadCap:dropDownHead class="CloudianChildDropDown">
                        <MadCap:dropDownHotspot>groupId</MadCap:dropDownHotspot>
                    </MadCap:dropDownHead>
                    <MadCap:dropDownBody>
                        <div class="Indent">
                            <p>(Optional, string) Group ID of the user to finish deleting.</p>
                            <p>If no user is specified, then this operation will get the list of all users in "Deleting" status and attempt to delete their data and metadata. If you do want to specify a user, then <b>either</b> use "userId" together with "groupId", <b>or</b> use "canonicalUserId" by itself.</p>
                        </div>
                    </MadCap:dropDownBody>
                </MadCap:dropDown>
                <MadCap:dropDown>
                    <MadCap:dropDownHead class="CloudianChildDropDown">
                        <MadCap:dropDownHotspot>canonicalUserId</MadCap:dropDownHotspot>
                    </MadCap:dropDownHead>
                    <MadCap:dropDownBody>
                        <div class="Indent">
                            <p>(Optional, string) System-generated canonical ID of the user to finish deleting. If you don’t know the user’s canonical ID, you can obtain it by using the <MadCap:xref href="../User Management/GetUserList.htm">GET User List</MadCap:xref> method (this method retrieves user profile information including canonical ID for users within a specified group).</p>
                            <p>If no user is specified, then this operation will get the list of all users in "Deleting" status and attempt to delete their data and metadata. If you do want to specify a user, then <b>either</b> use "userId" together with "groupId", <b>or</b> use "canonicalUserId" by itself.</p>
                        </div>
                    </MadCap:dropDownBody>
                </MadCap:dropDown>
                <h4>Request Payload</h4>
                <p>None.</p>
            </MadCap:dropDownBody>
        </MadCap:dropDown>
        <MadCap:dropDown>
            <MadCap:dropDownHead class="CloudianParentDropDown">
                <MadCap:dropDownHotspot>Response Format</MadCap:dropDownHotspot>
            </MadCap:dropDownHead>
            <MadCap:dropDownBody>
                <h4>Response Status</h4>
                <p>In addition to the <MadCap:xref href="../CommonStatusCodes.htm" target="_popup">Common Status Codes</MadCap:xref>, this method may return these codes:</p>
                <table style="border-collapse: separate;border-top-left-radius: 0px;border-top-right-radius: 0px;border-bottom-right-radius: 0px;border-bottom-left-radius: 0px;border-left-style: solid;border-left-width: 1px;border-right-style: solid;border-right-width: 1px;border-top-style: solid;border-top-width: 1px;border-bottom-style: solid;border-bottom-width: 1px;width: 100%;">
                    <col style="width: 115px;">
                    </col>
                    <col style="width: 629px;">
                    </col>
                    <thead>
                        <tr>
                            <th style="border-left-style: solid;border-left-width: 1px;border-right-style: solid;border-right-width: 1px;border-top-style: solid;border-top-width: 1px;border-bottom-style: solid;border-bottom-width: 1px;padding-left: 4px;">Status Code</th>
                            <th style="border-left-style: solid;border-left-width: 1px;border-right-style: solid;border-right-width: 1px;border-top-style: solid;border-top-width: 1px;border-bottom-style: solid;border-bottom-width: 1px;padding-left: 4px;">Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td style="border-left-style: solid;border-left-width: 1px;border-right-style: solid;border-right-width: 1px;border-top-style: solid;border-top-width: 1px;border-bottom-style: solid;border-bottom-width: 1px;padding-left: 4px;text-align: center;">400</td>
                            <td style="padding-left: 4px;padding-right: 4px;padding-top: 4px;padding-bottom: 4px;border-left-style: solid;border-left-width: 1px;border-right-style: solid;border-right-width: 1px;border-top-style: solid;border-top-width: 1px;border-bottom-style: solid;border-bottom-width: 1px;text-align: left;"> 	

Conflicting parameters: {canonicalUserId, groupId, userId}</td>
                        </tr>
                        <tr>
                            <td style="border-left-style: solid;border-left-width: 1px;border-right-style: solid;border-right-width: 1px;border-top-style: solid;border-top-width: 1px;border-bottom-style: solid;border-bottom-width: 1px;padding-left: 4px;text-align: center;">403</td>
                            <td style="padding-left: 4px;padding-right: 4px;padding-top: 4px;padding-bottom: 4px;border-left-style: solid;border-left-width: 1px;border-right-style: solid;border-right-width: 1px;border-top-style: solid;border-top-width: 1px;border-bottom-style: solid;border-bottom-width: 1px;text-align: left;"> 	

Unable to find user to delete.</td>
                        </tr>
                    </tbody>
                </table>
                <h4>Response Payload</h4>
                <p>None.</p>
            </MadCap:dropDownBody>
        </MadCap:dropDown>
        <MadCap:dropDown>
            <MadCap:dropDownHead class="CloudianParentDropDown">
                <MadCap:dropDownHotspot>Example</MadCap:dropDownHotspot>
            </MadCap:dropDownHead>
            <MadCap:dropDownBody>
                <p>In this example any "dangling" deleted users (users stuck in a "Deleting" status) are successfully deleted.</p><pre xml:space="preserve"># Request -&gt;

POST http://192.168.2.16:18081/system/deletedUserCleanup

# Response -&gt;

Status Code: 200 OK
Content-Length: 0
Date: Tue, 29 Sep 2015 11:57:18 GMT</pre>
            </MadCap:dropDownBody>
        </MadCap:dropDown>
    </body>
</html>