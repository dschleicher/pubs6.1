<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="HyperStoreHelp.xml" data-mc-path-to-help-system="../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Admin API|Methods|Billing">
    <!-- saved from url=(0016)http://localhost -->
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>POST User's Bill</title>
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Resources/Stylesheets/styles.css" rel="stylesheet" />
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="TopicContent">
            <div class="MCBreadcrumbsBox_0"><span class="MCBreadcrumbsPrefix">You are here: </span><a class="MCBreadcrumbsLink" href="../AdminApiOverview.htm">Admin API</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbsSelf">Methods</span><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="BillingOverview.htm">Billing</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">POST User's Bill</span>
            </div>
            <h1>POST User's Bill</h1>
            <p class="TopicTag" data-mc-conditions="General.Online">[Admin API Method]</p>
            <p>Use this Admin API method to generate a user’s monthly bill. This operation returns the newly generated bill in the response object.</p>
            <p>You can generate bills only for a month that has already completed. You cannot generate a bill for the current, in-progress month.</p>
            <p class="Important" data-mc-autonum="&lt;b&gt;IMPORTANT: &lt;/b&gt;"><span class="autonumber"><span><b>IMPORTANT: </b></span></span>Billing calculation is derived from hourly rollup usage data. The retention period for hourly rollup usage data is configured by <code>mts.properties: reports.rolluphour.ttl</code>. [XREF] The default retention period is 65 days. Once this rollup data is deleted it can no longer be used to generate users' bills.</p>
            <p class="Note" data-mc-autonum="&lt;b&gt;Note &#160;&lt;/b&gt;"><span class="autonumber"><span><b>Note &#160;</b></span></span>	If your HyperStore deployment has multiple regions, and if the user for whom you are generating a bill has storage buckets in multiple regions, the user’s monthly bill will aggregate the user’s service charges from across the multiple regions. If your service uses different rating plans in different regions, those rating plans are used in calculating the user’s region-specific charges before the region-specific charges are added together to get the user’s total bill for the month.</p>
            <div class="MCDropDown MCDropDown_Open dropDown"><span class="MCDropDownHead dropDownHead dropDownHeadCloudianParentDropDown"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="16" width="16" alt="Closed" data-mc-alt2="Open" />Request Format</a></span>
                <div class="MCDropDownBody dropDownBody">
                    <h4>Syntax</h4><pre xml:space="preserve">POST /billing?[userId=xxx&amp;groupId=xxx][canonicalUserId=xxx]&amp;billingPeriod=xxx</pre>
                    <h4>Query Parameters</h4>
                    <div class="MCDropDown MCDropDown_Open dropDown"><span class="MCDropDownHead dropDownHead dropDownHeadCloudianChildDropDown"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="16" width="16" alt="Closed" data-mc-alt2="Open" />userId</a></span>
                        <div class="MCDropDownBody dropDownBody">
                            <div class="Indent">
                                <p>(Optional, string) User ID for the user whose bill is being generated.</p>
                                <p>Do not use the "userId" and "groupId" parameters for a user who has been deleted from the S3 service. For a deleted user, use the "canonicalUserId" parameter instead.</p>
                                <p>You must <b>either</b> use "userId" together with "groupId", <b>or</b> use "canonicalUserId" by itself.</p>
                            </div>
                        </div>
                    </div>
                    <div class="MCDropDown MCDropDown_Open dropDown"><span class="MCDropDownHead dropDownHead dropDownHeadCloudianChildDropDown"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="16" width="16" alt="Closed" data-mc-alt2="Open" />groupId</a></span>
                        <div class="MCDropDownBody dropDownBody">
                            <div class="Indent">
                                <p>(Optional, string) &#160;Group ID for the user whose bill is being generated.</p>
                                <p>You must <b>either</b> use "userId" together with "groupId", <b>or</b> use "canonicalUserId" by itself.</p>
                            </div>
                        </div>
                    </div>
                    <div class="MCDropDown MCDropDown_Open dropDown"><span class="MCDropDownHead dropDownHead dropDownHeadCloudianChildDropDown"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="16" width="16" alt="Closed" data-mc-alt2="Open" />canonicalUserId</a></span>
                        <div class="MCDropDownBody dropDownBody">
                            <div class="Indent">
                                <p>(Optional, string) System-generated canonical ID for the user whose bill is being generated. Use this parameter if you want to generate a bill for a user who has been deleted from the system. If you don’t know the user’s canonical ID, you can obtain it by using the <a href="../User Management/GetUserList.htm" class="MCXref xref">GET User List</a> method (this method can retrieve user profile information — including canonical ID — for all deleted users within a specified group).</p>
                                <p>You must <b>either</b> use "userId" together with "groupId", <b>or</b> use "canonicalUserId" by itself.</p>
                            </div>
                        </div>
                    </div>
                    <div class="MCDropDown MCDropDown_Open dropDown"><span class="MCDropDownHead dropDownHead dropDownHeadCloudianChildDropDown"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="16" width="16" alt="Closed" data-mc-alt2="Open" />billingPeriod</a></span>
                        <div class="MCDropDownBody dropDownBody">
                            <div class="Indent">
                                <p>(Mandatory, string) Specifies the year and month of bill. Format is <em>yyyyMM</em> — for example "201601" for January 2016. Note that the system uses GMT time when demarcating exactly when a month begins and ends.</p>
                            </div>
                        </div>
                    </div>
                    <h4>Request Payload</h4>
                    <p>None.</p>
                </div>
            </div>
            <div class="MCDropDown MCDropDown_Open dropDown"><span class="MCDropDownHead dropDownHead dropDownHeadCloudianParentDropDown"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="16" width="16" alt="Closed" data-mc-alt2="Open" />Response Format</a></span>
                <div class="MCDropDownBody dropDownBody">
                    <h4>Response Status</h4>
                    <p>In addition to the <a href="../CommonStatusCodes.htm" class="MCTopicPopup MCTopicPopupHotSpot MCXref xref">Common Response Status Codes</a>, this method may return these codes:</p>
                    <table style="border-collapse: separate;border-top-left-radius: 0px;border-top-right-radius: 0px;border-bottom-right-radius: 0px;border-bottom-left-radius: 0px;border-left-style: solid;border-left-width: 1px;border-right-style: solid;border-right-width: 1px;border-top-style: solid;border-top-width: 1px;border-bottom-style: solid;border-bottom-width: 1px;width: 100%;">
                        <col style="width: 115px;" />
                        <col style="width: 629px;" />
                        <thead>
                            <tr>
                                <th style="border-left-style: solid;border-left-width: 1px;border-right-style: solid;border-right-width: 1px;border-top-style: solid;border-top-width: 1px;border-bottom-style: solid;border-bottom-width: 1px;padding-left: 4px;">Status Code</th>
                                <th style="border-left-style: solid;border-left-width: 1px;border-right-style: solid;border-right-width: 1px;border-top-style: solid;border-top-width: 1px;border-bottom-style: solid;border-bottom-width: 1px;padding-left: 4px;">Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="border-left-style: solid;border-left-width: 1px;border-right-style: solid;border-right-width: 1px;border-top-style: solid;border-top-width: 1px;border-bottom-style: solid;border-bottom-width: 1px;padding-left: 4px;text-align: center;">204</td>
                                <td style="padding-left: 4px;padding-right: 4px;padding-top: 4px;padding-bottom: 4px;border-left-style: solid;border-left-width: 1px;border-right-style: solid;border-right-width: 1px;border-top-style: solid;border-top-width: 1px;border-bottom-style: solid;border-bottom-width: 1px;text-align: left;">No billing data</td>
                            </tr>
                            <tr>
                                <td style="border-left-style: solid;border-left-width: 1px;border-right-style: solid;border-right-width: 1px;border-top-style: solid;border-top-width: 1px;border-bottom-style: solid;border-bottom-width: 1px;padding-left: 4px;text-align: center;">400</td>
                                <td style="padding-left: 4px;padding-right: 4px;padding-top: 4px;padding-bottom: 4px;border-left-style: solid;border-left-width: 1px;border-right-style: solid;border-right-width: 1px;border-top-style: solid;border-top-width: 1px;border-bottom-style: solid;border-bottom-width: 1px;text-align: left;"> 	

Invalid billing period</td>
                            </tr>
                            <tr>
                                <td style="border-left-style: solid;border-left-width: 1px;border-right-style: solid;border-right-width: 1px;border-top-style: solid;border-top-width: 1px;border-bottom-style: solid;border-bottom-width: 1px;padding-left: 4px;text-align: center;">400</td>
                                <td style="padding-left: 4px;padding-right: 4px;padding-top: 4px;padding-bottom: 4px;border-left-style: solid;border-left-width: 1px;border-right-style: solid;border-right-width: 1px;border-top-style: solid;border-top-width: 1px;border-bottom-style: solid;border-bottom-width: 1px;text-align: left;">Missing required parameter : {billingPeriod}</td>
                            </tr>
                            <tr>
                                <td style="border-left-style: solid;border-left-width: 1px;border-right-style: solid;border-right-width: 1px;border-top-style: solid;border-top-width: 1px;border-bottom-style: solid;border-bottom-width: 1px;padding-left: 4px;text-align: center;">400</td>
                                <td style="padding-left: 4px;padding-right: 4px;padding-top: 4px;padding-bottom: 4px;border-left-style: solid;border-left-width: 1px;border-right-style: solid;border-right-width: 1px;border-top-style: solid;border-top-width: 1px;border-bottom-style: solid;border-bottom-width: 1px;text-align: left;">Conflicting parameters: {canonicalUserId, groupId, userId}</td>
                            </tr>
                        </tbody>
                    </table>
                    <h4>Response Payload</h4>
                    <p><a href="../Data Objects/Bill.htm" class="MCXref xref">Bill</a> JSON object.</p>
                </div>
            </div>
            <div class="MCDropDown MCDropDown_Open dropDown"><span class="MCDropDownHead dropDownHead dropDownHeadCloudianParentDropDown"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_"><img class="MCDropDown_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="16" width="16" alt="Closed" data-mc-alt2="Open" />Example</a></span>
                <div class="MCDropDownBody dropDownBody">
                    <p>In this example, a bill for a user named "test" is successfully generated. The bill is for October, 2015, and indicates that total charges incurred by that user are $10.94, based on the user’s storage volume having been at an average level of 108GBs during the month of October.</p><pre xml:space="preserve"># Request -&gt;

POST http://10.10.3.26:18081/billing?userId=test&amp;groupId=test&amp;billingPeriod=201510

# Response -&gt;

Status Code: 200 OK
Content-Length: 450
Content-Type: application/json
Date: Mon, 23 Nov 2015 13:59:49 GMT
{"currency":"USD","total":10.94,"groupId":"test","userId":"test","canonicalUserId":
"42d737d3d55e83217dc568c72bf93ea3","whitelistTotal":0,"notes":null,"startCal":1443657600000,
"regionBills":[{"currency":"USD","total":10.94,"whitelistTotal":0,"whitelistItems":{},
"items":{"SB":{"item":"SB","rules":"1, 0.14:5, 0.12:0,0.10","quantity":108.00,"subtotal":10.94}},
"region":"region1"}],"billID":"67182a62-fd98-479e-a1e7-19588def4d95","endCal":1446335999000}</pre>
                    <p>For more information about Bill object attributes, see <a href="../Data Objects/Bill.htm" class="MCXref xref">Bill</a>.</p>
                </div>
            </div>
            <p style="font-size: 6pt;margin-top: 0;margin-bottom: 0;">&#160;</p>
        </div>
    </body>
</html>